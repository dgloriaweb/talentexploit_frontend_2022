import { defineStore } from 'pinia'
import { auth } from './auth.module'
import router from '../router'

// import axios from 'axios'

export const useStore = defineStore('main', {
  state: () => ({
    localstr: JSON.parse(localStorage.getItem('user')),
    loggedIn:  false,
    showlogin: false,
    showregister: false,
  }),
  getters: {
    getLoggedIn(state) {
      return state.loggedIn
    },
  },

  actions: {
    setShowLogin() {
      router.currentRoute._value.path != '/login' && !this.loggedIn
        ? this.showlogin = true
        : this.showlogin = false
    },
    setShowRegister() {
      router.currentRoute._value.path != '/register' && !this.loggedIn
        ? this.showregister = true
        : this.showregister = false
    },

    setLoggedIn() {
      if (this.localstr) {
        this.loggedIn = true
      } else {
        this.loggedIn = false
      }
    },
    logout() {
      localStorage.removeItem('user')
      this.loggedIn = false
    },
  },
  modules: {
    auth,
  },
})
